# MVCC

## 什么是MVCC

全称Multi-Version Concurrency Control，即**多版本并发控制**，主要是为了提高数据库的**并发性能**。

同一行数据平时发生读写请求时，会上锁阻塞住。但 mvcc 用更好的方式去处理读—写请求，做到在发生读—写请求冲突时不用加锁。

这个读是指的快照读，而不是当前读，当前读是一种加锁操作，是悲观锁。

### 当前读

它读取的数据库记录，都是`当前最新的版本`，会对当前读取的数据进行`加锁`，防止其他事务修改数据。是`悲观锁`的一种操作。

如下操作都是当前读：

- select lock in share mode (共享锁)

- select for update (排他锁)

- update (排他锁)

- insert (排他锁)

- delete (排他锁)

- 串行化事务隔离级别

### 快照读

快照读的实现是基于`多版本`并发控制，即MVCC，既然是多版本，那么快照读读到的数据不一定是当前最新的数据，有可能是之前`历史版本`的数据。

